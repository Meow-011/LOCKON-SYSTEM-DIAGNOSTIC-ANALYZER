# 
# Security Policy Configuration File
# ----------------------------------
# This file stores the policies for check_security.ps1
# (v5.7) NEW: Added more AV state codes (397568, 397328)
# (v5.5) NEW: Added AntivirusStateTranslations for localization.
# (v4.5) Removed DaysSinceUpdateThreshold

@{
    # === 4 & 7. Risky Ports Policy ===
    # (v4.0) Upgraded to object list for detailed reporting.
    # Define risky ports with their service name and risk description.

    RiskyPorts = @(
        @{ 
            Port = 21
            Service = "FTP (File Transfer Protocol)"
            Risk = "FTP เป็นบริการรับส่งไฟล์แบบดั้งเดิม บางระบบยังใช้ในงานภายในได้ แต่จุดที่ต้องระวังคือหลายกรณีส่งข้อมูล/รหัสผ่านแบบไม่เข้ารหัส หากเปิดให้คนนอกเข้าถึง หรือเปิดแบบไม่ตั้งค่าความปลอดภัย อาจถูกเดารหัสผ่านหรือถูกเข้าถึงไฟล์โดยไม่ตั้งใจ - ควรเปิดใช้เมื่อมีระบบรับส่งไฟล์ภายในองค์กร และจำกัดผู้ใช้/เครือข่ายไว้" 
        },
        @{ 
            Port = 22
            Service = "SSH (Secure Shell)"
            Risk = "SSH เป็นช่องทางที่ผู้ดูแลใช้เข้าจัดการเครื่องระยะไกล (โดยเฉพาะ Linux/อุปกรณ์เครือข่าย) จึงเป็นเรื่องปกติในระบบจำนวนมาก ความเสี่ยงมักเกิดเมื่อเปิดให้เข้าจากภายนอกโดยไม่จำกัด หรือใช้รหัสผ่านเดาง่าย เพราะอาจมีคนพยายามเดารหัสผ่านได้ - ควรเปิดใช้เมื่อเป็นเครื่องเซิร์ฟเวอร์/อุปกรณ์ที่ต้องให้ผู้ดูแลเข้าจัดการ และจำกัดการเข้าถึงแล้ว" 
        },
        @{ 
            Port = 23
            Service = "Telnet"
            Risk = "Telnet เป็นวิธี remote แบบเก่าที่ไม่เข้ารหัส ทำให้ถ้าเครือข่ายไม่ปลอดภัยอาจมีโอกาสถูกดักข้อมูลได้ ปัจจุบันมักแนะนำให้ใช้ SSH แทน - ยกเว้นกรณีเจอในอุปกรณ์เก่ามาก/ระบบ legacy ในวงปิดจริงๆ" 
        },
        @{ 
            Port = 25
            Service = "SMTP (Simple Mail Transfer Protocol)"
            Risk = "SMTP คือบริการส่งอีเมลระหว่างเซิร์ฟเวอร์อีเมล ดังนั้นบน Mail Server การเปิดพอร์ตนี้ถือว่าปกติ แต่บน เครื่องผู้ใช้ทั่วไป (Client/PC) มักไม่จำเป็น หากพบเปิดบนเครื่องผู้ใช้ อาจเป็นแอปที่ตั้งค่าผิด หรือเคสที่น่ากังวลคือเครื่องถูกใช้ส่งสแปม - เครื่องที่ควรเปิดใช้คือเครื่อง Mail Server/Relay ขององค์กร" 
        },
        @{ 
            Port = 135
            Service = "RPC (Remote Procedure Call)"
            Risk = "เป็นส่วนหนึ่งของ Windows สำหรับการทำงาน/จัดการบริการภายในเครือข่าย โดยตัวมันเองไม่ได้แปลว่าถูกแฮก และพบได้ปกติในเครื่อง Windows/Server ภายในองค์กร ความเสี่ยงจะเพิ่มขึ้นเมื่อเปิดให้คนที่ไม่เกี่ยวข้องเข้าถึงจากเครือข่ายกว้าง เพราะอาจทำให้คนภายนอกมองเห็นตัว Service บางอย่างได้มากขึ้น - ยกเว้นว่า Windows อยู่ในเครือข่ายองค์กร (จำกัดอยู่ภายใน)" 
        },
        @{ 
            Port = 137
            Service = "NetBIOS Name Service (NBNS, UDP/137)"
            Risk = "เป็นเทคโนโลยีเก่าที่เกี่ยวกับการประกาศชื่อเครื่อง/การแชร์ไฟล์แบบยุคก่อน (SMB ผ่าน NetBIOS) บางองค์กรยังเจอในระบบเก่า ความเสี่ยงหลักคือเพิ่มข้อมูลที่คนอื่นมองเห็นในเครือข่าย และอาจช่วยให้การสำรวจทรัพยากรภายในทำได้ง่ายขึ้น - ยกเว้นว่าเครือข่ายภายในที่ยังมีระบบเก่า/การแชร์แบบเดิม" 
        },
        @{ 
            Port = 138
            Service = "NetBIOS Datagram Service (UDP/138)"
            Risk = "เป็นเทคโนโลยีเก่าที่เกี่ยวกับการประกาศชื่อเครื่อง/การแชร์ไฟล์แบบยุคก่อน (SMB ผ่าน NetBIOS) บางองค์กรยังเจอในระบบเก่า ความเสี่ยงหลักคือเพิ่มข้อมูลที่คนอื่นมองเห็นในเครือข่าย และอาจช่วยให้การสำรวจทรัพยากรภายในทำได้ง่ายขึ้น - ยกเว้นว่าเครือข่ายภายในที่ยังมีระบบเก่า/การแชร์แบบเดิม"
        },
        @{ 
            Port = 139
            Service = "NetBIOS Session Service"
            Risk = "เป็นเทคโนโลยีเก่าที่เกี่ยวกับการประกาศชื่อเครื่อง/การแชร์ไฟล์แบบยุคก่อน (SMB ผ่าน NetBIOS) บางองค์กรยังเจอในระบบเก่า ความเสี่ยงหลักคือเพิ่มข้อมูลที่คนอื่นมองเห็นในเครือข่าย และอาจช่วยให้การสำรวจทรัพยากรภายในทำได้ง่ายขึ้น - ยกเว้นว่าเครือข่ายภายในที่ยังมีระบบเก่า/การแชร์แบบเดิม"
        },
        @{ 
            Port = 445
            Service = "SMB (Server Message Block)"
            Risk = "SMB คือการแชร์ไฟล์/พรินเตอร์ของ Windows และการทำงานในโดเมน เป็นบริการปกติในหลายองค์กร แต่เพราะมันสำคัญและใช้เยอะ จึงเป็นเป้าหมายยอดนิยม เวลามีการตั้งค่าหลวม/ไม่ได้อัปเดตแพตช์ ความเสี่ยงจะสูงขึ้นมาก โดยเฉพาะถ้าเปิดออกอินเทอร์เน็ต - ใช้ในกรณีแชร์ไฟล์ภายในองค์กร บน File Server/เครื่องที่จำเป็น"
        },
        @{ 
            Port = 1433
            Service = "SQL Server (MSSQL)"
            Risk = "เป็นบริการฐานข้อมูลของ Microsoft SQL Server ปกติพบได้บนเครื่อง Database Server ความเสี่ยงสูงเมื่อเปิดให้เข้าจากภายนอกโดยตรง เพราะฐานข้อมูลเป็นข้อมูลสำคัญและมักถูกลองเดารหัสผ่าน/โจมตีบัญชี - DB Server ภายใน และให้แอป/เซิร์ฟเวอร์ที่เกี่ยวข้องเท่านั้นเชื่อมต่อ"
        },
        @{ 
            Port = 3306
            Service = "MySQL Database"
            Risk = "คล้าย MSSQL คือเป็นบริการฐานข้อมูล ปกติพบได้บน DB Server ความเสี่ยงหลักเกิดเมื่อเปิดให้คนภายนอกเข้าถึงโดยตรงหรือไม่มีการจำกัดสิทธิ์ เพราะอาจนำไปสู่ข้อมูลรั่วไหลหรือถูกแก้ไข - ยกเว้นกรณีใช้ภายในและจำกัดการเชื่อมต่อเฉพาะระบบที่เกี่ยวข้อง" 
        },
        @{ 
            Port = 3389
            Service = "RDP (Remote Desktop Protocol)"
            Risk = "RDP คือ Remote Desktop ของ Windows ใช้บริหารจัดการได้สะดวกและพบได้บ่อย ไม่ได้ผิดปกติ หากใช้ในวงภายในและกำหนดสิทธิ์ดี แต่ถ้าเปิดสู่ Internet จะถูกลองเดารหัสผ่านบ่อยมาก และถ้าหลุดอาจถูกใช้ยึดเครื่องได้ - ใช้ในเครือข่ายองค์กร/ผ่าน VPN/จำกัด IP"
        },
        @{ 
            Port = 5900
            Service = "VNC (Virtual Network Computing)"
            Risk = "VNC คือ remote desktop อีกแบบหนึ่ง บางระบบใช้จริงในการดูแลเครื่อง แต่บางครั้งก็ถูกใช้เป็นเครื่องมือ remote ที่ติดตั้งแบบไม่ตั้งใจ จุดเสี่ยงคือถ้าตั้งค่าหลวม/ไม่เข้ารหัส หรือเปิดให้เข้าถึงกว้าง ๆ อาจทำให้คนอื่นควบคุมหน้าจอได้ - เปิดในกรณีระบบที่ตั้งใจใช้ VNC และมีการจำกัดการเข้าถึงแล้ว"
        },
        @{ 
            Port = 5985
            Service = "WinRM (HTTP)"
            Risk = "WinRM คือช่องทางผู้ดูแลใช้ PowerShell remoting เพื่อจัดการ Windows ระยะไกล บนระบบองค์กรถือว่ามีประโยชน์และพบได้ปกติ แต่เพราะเป็นช่องทาง admin ความเสี่ยงจะเพิ่มขึ้นมากถ้าเปิดกว้างเกินไป - เปิดในกรณีเป็นระบบจัดการเครื่องในองค์กร (เช่น automation/management) และจำกัดเครือข่าย/สิทธิ์แล้ว" 
        },
        @{ 
            Port = 5986
            Service = "WinRM (HTTPS)"
            Risk = "WinRM คือช่องทางผู้ดูแลใช้ PowerShell remoting เพื่อจัดการ Windows ระยะไกล บนระบบองค์กรถือว่ามีประโยชน์และพบได้ปกติ แต่เพราะเป็นช่องทาง admin ความเสี่ยงจะเพิ่มขึ้นมากถ้าเปิดกว้างเกินไป - เปิดในกรณีเป็นระบบจัดการเครื่องในองค์กร (เช่น automation/management) และจำกัดเครือข่าย/สิทธิ์แล้ว" 
        },
        @{ 
            Port = 53
            Service = "DNS (Domain Name System)"
            Risk = "DNS คือบริการแปลงชื่อเว็บ/โดเมนให้เป็น IP เพื่อให้เครื่องติดต่อกันได้ ปกติพอร์ตนี้ควรเปิดบน DNS Server หรืออุปกรณ์เครือข่ายที่ทำหน้าที่ตอบคำถาม DNS เท่านั้น ถ้าพบบนเครื่อง Client/PC ทั่วไป อาจเป็นการตั้งค่าผิด มีโปรแกรมทำ DNS เอง (เช่น service สำหรับองค์กร/แอปบางชนิด) หรือกรณีที่ต้องตรวจเพิ่มคือมีซอฟต์แวร์ไม่พึงประสงค์พยายามควบคุมการชี้ DNS (DNS hijacking) - ควรเปิดใช้เมื่อเครื่องนั้นเป็น DNS Server/Firewall/Router หรือระบบที่ตั้งใจให้บริการ DNS ภายใน และจำกัดการเข้าถึงเฉพาะเครือข่ายที่เกี่ยวข้อง" 
        },
        @{ 
            Port = 1080
            Service = "SOCKS Proxy"
            Risk = "SOCKS Proxy คือบริการตัวกลางที่ช่วยส่งทราฟฟิกออกไปแทนผู้ใช้ มักใช้ทำ tunnel หรือ proxy ในงานดูแลระบบ/งานพัฒนา ซึ่งถือว่าใช้งานได้ตามปกติในบางบริบท แต่ถ้าเปิดค้างบนเครื่องทั่วไปหรือเปิดให้เข้าถึงจากภายนอกโดยไม่จำกัด อาจถูกผู้อื่นใช้เป็น 'ทางผ่าน' เพื่อซ่อนตัวหรือส่งทราฟฟิกผิดปกติ ทำให้ตรวจสอบต้นทางยากและเสี่ยงต่อภาพลักษณ์/ความปลอดภัยเครือข่าย - ควรเปิดใช้เมื่อเป็น Proxy Server ที่ตั้งใจใช้งาน หรือเป็นเครื่อง admin/dev ที่มีเหตุผลชัดเจน และต้องจำกัด IP/ผู้ใช้ที่เข้าถึงได้" 
        },
        @{ 
            Port = 3128
            Service = "Squid Proxy"
            Risk = "พอร์ตนี้มักเป็น Proxy สำหรับการท่องเว็บแบบรวมศูนย์ (เช่น Squid) ซึ่งองค์กรจำนวนมากใช้เพื่อควบคุม/กรองเว็บหรือทำแคชให้เร็วขึ้น จึงไม่ได้อันตรายเสมอไป ความเสี่ยงจะเกิดเมื่อเปิดแบบกว้างหรือกลายเป็น 'open proxy' เพราะบุคคลภายนอกอาจนำไปใช้เป็นทางผ่านทำกิจกรรมไม่พึงประสงค์จน IP/องค์กรถูก blacklist หรือเกิดการรั่วไหลของทราฟฟิก - ควรเปิดใช้เมื่อเครื่องนั้นเป็น Proxy Server ขององค์กรและมีการจำกัดเครือข่าย/ผู้ใช้ที่อนุญาต พร้อมตั้งค่าความปลอดภัยให้รัดกุม" 
        },
        @{ 
            Port = 8080
            Service = "HTTP Alternate / Proxy"
            Risk = "8080 เป็นพอร์ตเว็บทางเลือกที่หลายระบบใช้รันเว็บแอป หน้าแอดมิน หรือเว็บทดสอบ การพบพอร์ตนี้ไม่ได้แปลว่าอันตรายทันที เพราะอาจเป็นบริการปกติของระบบ แต่ความเสี่ยงจะเพิ่มขึ้นถ้าเป็นหน้าแอดมิน/คอนโซลที่ตั้งค่าหลวม (เช่นรหัสผ่านเริ่มต้น/ไม่มีการจำกัดสิทธิ์/ไม่ได้อัปเดต) หรือเปิดให้เข้าถึงจากภายนอกโดยไม่จำเป็น - ควรเปิดใช้เมื่อเป็นบริการเว็บที่จำเป็นต่อระบบจริง และควรจำกัดการเข้าถึง (เช่นเฉพาะภายใน/VPN/allowlist) โดยเฉพาะถ้าเป็นหน้าแอดมิน" 
        },
        @{ 
            Port = 8443
            Service = "HTTPS Alternate / Proxy"
            Risk = "8443 เป็นพอร์ตเว็บแบบเข้ารหัส (HTTPS) ที่มักใช้กับหน้าแอดมินหรือคอนโซลของซอฟต์แวร์หลายชนิด เช่นระบบจัดการ/คอนเทนเนอร์/แผงควบคุมต่าง ๆ โดยรวมถือว่าปลอดภัยกว่า HTTP เพราะเข้ารหัสการสื่อสาร แต่ยังไม่ควรเปิดกว้างเสมอไป หากเปิดสู่ Internet หรือไม่มีการจำกัดผู้ใช้ อาจถูกลองเดารหัสผ่านหรือโจมตีช่องโหว่ของเว็บ/คอนโซลนั้นได้ - ควรเปิดใช้เมื่อเป็นคอนโซลหรือเว็บแอปที่จำเป็น และจำกัดการเข้าถึงเฉพาะผู้ดูแล/เครือข่ายภายในหรือผ่าน VPN" 
        },
        @{ 
            Port = 5432
            Service = "PostgreSQL"
            Risk = "PostgreSQL คือบริการฐานข้อมูลที่เก็บข้อมูลสำคัญของระบบ ปกติพอร์ตนี้ควรเปิดเฉพาะในเครือข่ายภายในและให้เฉพาะแอปหรือเซิร์ฟเวอร์ที่เกี่ยวข้องเชื่อมต่อ ไม่ได้อันตรายถ้าอยู่ในวงจำกัดและตั้งค่าถูกต้อง แต่ถ้าเปิดสู่ภายนอกหรือเปิดให้เข้าถึงได้กว้าง จะเสี่ยงถูกลองเดารหัสผ่าน/ใช้บัญชีรั่วไหล และทำให้ข้อมูลรั่วไหลหรือถูกแก้ไข - ควรเปิดใช้เมื่อเป็น DB Server ภายใน และจำกัดการเชื่อมต่อเฉพาะระบบที่จำเป็น (เช่น App Server) เท่านั้น" 
        },
        @{ 
            Port = 6379
            Service = "Redis"
            Risk = "Redis มักถูกใช้เป็นแคชหรือฐานข้อมูลแบบ in-memory เพื่อช่วยให้ระบบทำงานเร็วขึ้น ในหลายองค์กรถือว่าเป็นบริการภายในที่พบได้ปกติ แต่แนวปฏิบัติทั่วไปคือไม่ควรเปิดให้เข้าถึงจากภายนอก เพราะบางระบบอาจตั้งค่า auth/permission ไม่รัดกุม หากเปิดกว้างอาจถูกเข้าถึงข้อมูลหรือถูกใช้งานผิดวัตถุประสงค์จนกระทบระบบได้ - ควรเปิดใช้เมื่อเป็นบริการภายในสำหรับแอป (cache/queue/session) และต้องจำกัดการเข้าถึงเฉพาะเครือข่าย/เครื่องที่เกี่ยวข้องเท่านั้น" 
        },
        @{ 
            Port = 27017
            Service = "MongoDB"
            Risk = "MongoDB คือบริการฐานข้อมูลที่อาจเก็บข้อมูลจำนวนมากและสำคัญ พอร์ตนี้บน DB Server ภายในถือว่าพบได้ปกติ แต่ไม่ควรเปิดสู่ Internet โดยตรง เพราะหากตั้งค่าไม่รัดกุม (เช่นไม่ได้เปิด auth หรือเปิดกว้างเกิน) อาจทำให้ข้อมูลรั่วไหล ถูกแก้ไข หรือลบได้ เคยมีเหตุการณ์จริงจำนวนมากที่ฐานข้อมูลถูกเปิดทิ้งไว้และถูกเข้าถึง - ควรเปิดใช้เมื่อเป็น DB Server ภายในและจำกัดการเชื่อมต่อเฉพาะแอป/เซิร์ฟเวอร์ที่จำเป็นเท่านั้น" 
        }
    )

    # === Report Folder Policy ===
    # The main folder (in the script's root) to store all reports.


    # === (v5.7) Antivirus State Translations ===
    # Define the translations for AV state codes.
    # The script will use these to populate the report.
    # It will fall back to English if a code is missing.
    AntivirusStateTranslations = @(
        @{ Code = "397312"; Status = "Running"; Description = "เปิดสมบูรณ์แบบ (Real-time protection ทำงาน)" },
        @{ Code = "397568"; Status = "Running"; Description = "เปิดสมบูรณ์แบบ (อัปเดตล่าสุด)" }, # (v5.7) NEW
        @{ Code = "397584"; Status = "Running"; Description = "เปิดสมบูรณ์แบบ (อัปเดตและป้องกันครบถ้วน)" }, # Win11/Modern Defender
        @{ Code = "393216"; Status = "Running"; Description = "เปิดอยู่ (แต่ Real-time protection อาจจะถูกปิดไว้ชั่วคราว)" },
        @{ Code = "393232"; Status = "WARN";    Description = "เปิดอยู่ (แต่ต้องการการดำเนินการ/สแกน)" }, # Action Needed
        @{ Code = "397328"; Status = "Running"; Description = "เปิดอยู่ (แต่ต้องการรีบูตเครื่อง)" }, # (v5.7) NEW
        @{ Code = "266240"; Status = "Not Running"; Description = "ปิด (Off)" },
        @{ Code = "393472"; Status = "Not Running"; Description = "ปิดชั่วคราว (Snoozed) (มักเกิดเมื่อมี AV ตัวอื่นทำงานอยู่)" }
        # Add other state codes here as you discover them
    )

    # === Unwanted Software Policy ===
    # List of software names (partial match) that violate company policy.
    UnwantedSoftware = @(
        "uTorrent",
        "BitTorrent",
        "Cheat Engine",
        "Baidu",
        "KMSPico",
        "KMSAuto",
        "Microsoft Toolkit",
        "AAct",
        "Re-Loader",
        "HWIDGen",
        "Keygen",
        "Mimikatz"
    )

    # === (v8.2) System Paths (Centralized Database Locations) ===
    # These paths are relative to the script execution folder ($PSScriptRoot).
    # Modules should use these values via $Config.SystemPaths
    SystemPaths = @{
        CriticalKBs  = "Database/critical_kbs.txt"
        ThreatDB     = "Database/threat_db.txt"
        Baseline     = "Database/config_baseline.json"
        UnitsConfig  = "Database/config_units.json"
    }

    # (v8.3) Main Report Folder (Relative to script root)
    MainReportFolder = "AuditReports";
}